CREATE PROCEDURE [dbo].[PRPagination](
	@RPP			  INT				    = 30,			/* REGISTERS PER PAGE */
	@FIELDS			VARCHAR(1000)	= '[ALL-TO-GET-IN-RESPONSE-COMMA-SEPARATED]',		/* FIELDS TO GET IN RESPONSE COMMA SEPARATED */
	@WHERE			VARCHAR(1000)	= '',					/* WHERE CLOUSULE STARTING WITH ' AND ...' */
	@ORDERBY		VARCHAR(100)	= '[FIELDS-TO-SORT]',	/* FIELD TO SORT */
	@SORT			  VARCHAR(5)		= '[ASC-OR-DESC]',		/* SORT: ASC OR DESC */
	@START			INT				    = 0						/* PAGE NUMBER STARTING ON 0 */
)
AS
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET NOCOUNT ON

DECLARE @PAGE	INT
SET @PAGE = @RPP * @START
	
EXEC('SELECT TOP '+ @RPP +' '+ @FIELDS +' FROM (
	SELECT
		[ALL-FIELDS-COMMA-SEPARATED],
		ROW_NUMBER() OVER (ORDER BY '+ @ORDERBY +' '+ @SORT +') AS lineNum,
		(SELECT COUNT(*) FROM dbo.[VIEW-NAME] WITH (NOLOCK) WHERE 1=1 '+ @WHERE +') AS total
	FROM
		dbo.[VIEW-NAME]
	WHERE
		1=1 '+
		@WHERE +'
	GROUP BY
		[ALL-FIELDS-COMMA-SEPARATED]
	) AS tmptable
	WHERE
		lineNum > '+ @PAGE +'
	ORDER BY
		lineNum ASC'
)
